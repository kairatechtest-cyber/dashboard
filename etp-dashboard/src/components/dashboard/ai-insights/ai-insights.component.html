<div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-lg h-full flex flex-col">
  <div class="flex items-center justify-between mb-3">
    <div class="flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-purple-500 dark:text-purple-400">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 01-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 013.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 013.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 01-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.553L16.5 21.75l-.398-1.197a3.375 3.375 0 00-2.456-2.456L12.75 18l1.197-.398a3.375 3.375 0 002.456-2.456L17.25 14.25l.398 1.197a3.375 3.375 0 002.456 2.456L21 18.75l-1.197.398a3.375 3.375 0 00-2.456 2.456z" />
      </svg>
      <h3 class="text-md font-bold text-gray-900 dark:text-white">AI-Powered Insights</h3>
    </div>
    <button (click)="fetchInsights()" [disabled]="isLoading()" class="text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white disabled:opacity-50 disabled:cursor-wait">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" [class.animate-spin]="isLoading()">
        <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.664 0l3.181-3.183m-11.664 0l3.181-3.183a8.25 8.25 0 00-11.664 0l3.181 3.183" />
      </svg>
    </button>
  </div>
  <div class="flex-grow text-sm text-gray-700 dark:text-gray-300 overflow-y-auto pr-2 min-h-[150px]">
    @if (isLoading()) {
      <div class="space-y-3 animate-pulse">
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"></div>
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6"></div>
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"></div>
      </div>
    } @else if (error()) {
      <div class="text-red-700 dark:text-red-400 bg-red-100 dark:bg-red-900/20 p-3 rounded">
        <p class="font-semibold">Error</p>
        <p>{{ error() }}</p>
      </div>
    } @else if (insights(); as text) {
      <p class="whitespace-pre-wrap">{{ text }}</p>
    } @else {
      <div class="flex items-center justify-center h-full">
        <p class="text-gray-500 dark:text-gray-400">Click refresh to get AI insights.</p>
      </div>
    }
  </div>
</div>
